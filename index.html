<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”„ë¦¬ë¯¸ì—„ ê²°ì œ ê³„ì‚°ê¸° (ì˜¤ë¦¬ì§€ë„ UI ìœ ì§€)</title>
    <style>
        /* 1. ë””ìì¸ (CSS) - ì˜¤ë¦¬ì§€ë„ 4x5 UI ìŠ¤íƒ€ì¼ ë³µêµ¬ */
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f2f5; /* ë°ì€ ë°°ê²½ ìœ ì§€ */
            font-family: 'Arial', sans-serif;
        }

        .calculator {
            background-color: #333; /* ë‹¤í¬ í…Œë§ˆ ë°°ê²½ */
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            width: 300px;
        }

        .display-wrapper { 
            position: relative; 
            margin-bottom: 20px; 
        }

        #display {
            width: 100%;
            height: 60px;
            background-color: #eee;
            border: none;
            border-radius: 10px;
            text-align: right;
            padding: 10px;
            font-size: 2rem;
            box-sizing: border-box;
            color: #333;
        }

        /* í”„ë¦¬ë¯¸ì—„ ë°°ì§€ */
        #premiumBadge {
            position: absolute;
            top: 5px;
            left: 10px;
            background-color: gold;
            color: #333;
            padding: 2px 6px;
            border-radius: 5px;
            font-size: 0.8rem;
            font-weight: bold;
            display: none;
        }

        /* ë²„íŠ¼ ê·¸ë¦¬ë“œ (4x5 ë ˆì´ì•„ì›ƒ ë³µêµ¬) */
        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        button {
            height: 60px;
            border: none;
            border-radius: 10px; /* ì‚¬ê° ë‘¥ê·¼ ëª¨ì–‘ */
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.95); }
        .btn-number { background-color: #666; color: white; }
        .btn-operator { background-color: #ff9f43; color: white; }
        .btn-clear { background-color: #ee5253; color: white; }
        .btn-equal { background-color: #2e86de; color: white; grid-column: span 2; }


        /* íŒì—… ìŠ¤íƒ€ì¼ (ìµœì¢… ë²„ì „ ìœ ì§€) */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 1000; justify-content: center; align-items: center; }
        #confirmationModal { z-index: 2000; }
        #processingModal { z-index: 3000; }
        .modal-content { background: white; padding: 30px; border-radius: 15px; text-align: center; width: 300px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); }
        .processing-box { background: white; padding: 50px; border-radius: 15px; text-align: center; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); }
        .price-option {
            border: 2px solid #ddd; padding: 15px; margin: 15px 0; border-radius: 10px; cursor: pointer; transition: border-color 0.2s, background 0.2s; display: flex; justify-content: space-between; align-items: flex-start;
        }
        .price-option:hover { background: #f0f8ff; }
        .price-option.selected { border-color: #ff9f43; background-color: #fff8e1; box-shadow: 0 0 5px rgba(255, 159, 67, 0.5); }
        .option-details { text-align: left; line-height: 1.5; }
        .option-price { color: #ff9f43; font-weight: bold; font-size: 1.2rem; margin-top: 5px; }
        #payButton { width: 100%; height: 50px; background-color: #ddd; color: #333; margin-top: 25px; font-size: 1.2rem; border-radius: 8px; font-weight: bold; }
        #payButton:not(:disabled) { background-color: #2e86de; color: white; }
        #payButton:disabled { background-color: #ddd; color: #666; cursor: not-allowed; }
        #laterButton { width: auto; height: 35px; padding: 0 15px; font-size: 1rem; font-weight: normal; background-color: transparent; color: #777; border: none; margin-top: 10px; border-radius: 8px; display: block; margin-left: auto; margin-right: auto; }
        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ë° ê¸°íƒ€ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        .spinner { border: 5px solid #f3f3f3; border-top: 5px solid #2e86de; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto 15px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .success-icon { font-size: 60px; color: green; line-height: 1; display: none; margin: 0 auto 15px auto; }
        .pay-confirm-btn { background-color: #2e86de; color: white; height: 45px; width: 45%; margin: 10px 5px; font-size: 1rem; }
        .pay-cancel-btn { background-color: #eee; color: #333; height: 45px; width: 45%; margin: 10px 5px; font-size: 1rem; }
    </style>
</head>
<body>

    <div class="calculator">
        <div class="display-wrapper">
            <input type="text" id="display" readonly value="0">
            <span id="premiumBadge">â˜… PREMIUM</span>
        </div>
        <div class="buttons">
            <button class="btn-clear" onclick="clearDisplay()">C</button>
            <button class="btn-operator" onclick="appendOperator('/')">/</button>
            <button class="btn-operator" onclick="appendOperator('*')">Ã—</button>
            <button class="btn-operator" onclick="appendOperator('-')">-</button>
            
            <button class="btn-number" onclick="appendNumber('7')">7</button>
            <button class="btn-number" onclick="appendNumber('8')">8</button>
            <button class="btn-number" onclick="appendNumber('9')">9</button>
            <button class="btn-operator" onclick="appendOperator('+')">+</button>
            
            <button class="btn-number" onclick="appendNumber('4')">4</button>
            <button class="btn-number" onclick="appendNumber('5')">5</button>
            <button class="btn-number" onclick="appendNumber('6')">6</button>
            <button class="btn-number" onclick="appendNumber('.')">.</button>

            <button class="btn-number" onclick="appendNumber('1')">1</button>
            <button class="btn-number" onclick="appendNumber('2')">2</button>
            <button class="btn-number" onclick="appendNumber('3')">3</button>
            <button class="btn-number" onclick="appendNumber('0')">0</button>
            
            <button class="btn-equal" onclick="calculateResult()">=</button>
        </div>
    </div>
    
    <div id="subscriptionModal" class="modal-overlay">
        <div class="modal-content">
            <h3>ğŸ”’ í”„ë¦¬ë¯¸ì—„ ê³„ì‚°ê¸° êµ¬ë…</h3>
            <p>ì´ ê³„ì‚°ê¸°ë¥¼ ê³„ì† ì‚¬ìš©í•˜ë ¤ë©´ í”Œëœì„ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
            
            <div class="price-option" id="plan-1" onclick="selectPlan(1)">
                <div class="option-details">
                    1ê°œì›” êµ¬ë… (ì›”ê°„ ê²°ì œ) <br>
                    **ì •ê°€:** 9,900ì› / ì›”
                </div>
                <strong class="option-price" id="price1Month">9,900ì›</strong>
            </div>
            
            <div class="price-option" id="plan-12" onclick="selectPlan(12)">
                <div class="option-details">
                    12ê°œì›” êµ¬ë… (ì—°ê°„ ê²°ì œ) <br>
                    **10% í• ì¸ í˜œíƒ!**
                </div>
                <strong class="option-price" id="price12Month">106,920ì›</strong>
            </div>

            <p style="font-size: 0.8rem; color: #555;">(12ê°œì›” êµ¬ë…ì€ ì›” ì•½ 8,910ì› ê¼´)</p>
            
            <button id="payButton" onclick="attemptPayment()" disabled>ê²°ì œí•˜ê¸°</button> 
            <button id="laterButton" onclick="closeModal(subscriptionModal)">ë‚˜ì¤‘ì— í•˜ê¸°</button>
        </div>
    </div>
    
    <div id="confirmationModal" class="modal-overlay">
        <div class="modal-content" style="width: 280px;">
            <h4>ê²°ì œ ì§„í–‰ í™•ì¸</h4>
            <p id="confirmMessageText" style="font-size: 1.1rem; font-weight: bold;"></p> 
            <p style="font-size: 0.9rem; color: #cc3300;">(ê²½ê³ : ë¸Œë¼ìš°ì € ì¿ í‚¤ ë°ì´í„°ë¥¼ ì´ìš©í•´ ê²°ì œë¥¼ ì‹œë„í•©ë‹ˆë‹¤)</p>
            
            <button class="pay-confirm-btn" onclick="processPayment(true)">ê²°ì œ ì§„í–‰</button>
            <button class="pay-cancel-btn" onclick="processPayment(false)">ì·¨ì†Œ</button>
        </div>
    </div>
    
    <div id="processingModal" class="modal-overlay">
        <div class="processing-box">
            <div id="spinner" class="spinner"></div>
            <div id="successIcon" class="success-icon">âœ“</div>
            <p id="processingText">ê²°ì œë¥¼ ì²˜ë¦¬í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
        </div>
    </div>


    <script>
        // 3. ê¸°ëŠ¥ (JavaScript) - ë‹¨ìˆœ ë¬¸ìì—´ ê³„ì‚° ë¡œì§ ë³µêµ¬
        const display = document.getElementById('display');
        const subscriptionModal = document.getElementById('subscriptionModal');
        const confirmationModal = document.getElementById('confirmationModal');
        const processingModal = document.getElementById('processingModal'); 
        const payButton = document.getElementById('payButton');
        const confirmMessageText = document.getElementById('confirmMessageText');
        const spinner = document.getElementById('spinner');
        const successIcon = document.getElementById('successIcon');
        const processingText = document.getElementById('processingText');
        const premiumBadge = document.getElementById('premiumBadge'); 

        let currentExpression = ''; // í˜„ì¬ ì…ë ¥ëœ ìˆ˜ì‹ ì €ì¥
        let selectedPlanId = null; 
        
        // ì—°ê°„ êµ¬ë… ê°€ê²© ê³„ì‚° ë° ì—…ë°ì´íŠ¸
        const monthlyPrice = 9900;
        const annualPrice = monthlyPrice * 12;
        const annualDiscount = annualPrice * 0.10;
        const finalAnnualPrice = annualPrice - annualDiscount;
        document.getElementById('price12Month').innerText = finalAnnualPrice.toLocaleString() + 'ì›';
        
        // --- ìƒíƒœ ê´€ë¦¬ í•¨ìˆ˜ ---
        function checkPremiumStatus() {
            if (sessionStorage.getItem('isPremiumActive') === 'true') {
                premiumBadge.style.display = 'inline-block';
            } else {
                premiumBadge.style.display = 'none';
            }
        }
        
        // --- ê³„ì‚°ê¸° ë™ì‘ í•¨ìˆ˜ (eval ê¸°ë°˜ìœ¼ë¡œ ë³µêµ¬) ---
        
        // ìˆ«ì ë° . ì…ë ¥
        function appendNumber(value) {
            currentExpression = display.value === '0' ? value : display.value + value;
            display.value = currentExpression;
        }

        // ì—°ì‚°ì ì…ë ¥
        function appendOperator(operator) {
            // ë””ìŠ¤í”Œë ˆì´ê°€ ë¹„ì–´ìˆì§€ ì•Šê³ , ë§ˆì§€ë§‰ ë¬¸ìê°€ ì—°ì‚°ìê°€ ì•„ë‹ ë•Œë§Œ ì¶”ê°€
            const lastChar = display.value.slice(-1);
            if (display.value !== '' && !['/', '*', '+', '-'].includes(lastChar)) {
                currentExpression = display.value + operator;
                display.value = currentExpression;
            }
        }

        // ì´ˆê¸°í™” (C ë²„íŠ¼)
        function clearDisplay() {
            display.value = '0';
            currentExpression = '';
            selectedPlanId = null;
        }

        // --- íŒì—… ë° ê²°ì œ ë¡œì§ (ìœ ì§€) ---
        function closeModal(modalElement) {
            modalElement.style.display = 'none';
        }

        // = ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í˜¸ì¶œ
        function calculateResult() {
            if (display.value === '' || display.value === '0') return;
            currentExpression = display.value; 
            
            // í”„ë¦¬ë¯¸ì—„ ìƒíƒœ í™•ì¸: í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ë°”ë¡œ ê³„ì‚° ì‹¤í–‰
            if (sessionStorage.getItem('isPremiumActive') === 'true') {
                executeCalculation(); 
                return;
            }
            
            // í”„ë¦¬ë¯¸ì—„ì´ ì•„ë‹ˆë©´ êµ¬ë… íŒì—… ë„ìš°ê¸°
            subscriptionModal.style.display = 'flex';
            selectedPlanId = null; 
            payButton.disabled = true; 
            document.querySelectorAll('.price-option').forEach(el => el.classList.remove('selected'));
        }
        
        function selectPlan(planId) {
            document.querySelectorAll('.price-option').forEach(el => el.classList.remove('selected'));
            document.getElementById('plan-' + planId).classList.add('selected');
            selectedPlanId = planId;
            payButton.disabled = false;
        }

        function attemptPayment() {
            if (selectedPlanId === null) return; 
            closeModal(subscriptionModal);
            showConfirmationModal();
        }
        
        function showConfirmationModal() {
            const selectedPlanText = selectedPlanId === 1 ? '1ê°œì›” í”Œëœ' : '12ê°œì›” í”Œëœ';
            confirmMessageText.innerText = `${selectedPlanText}ìœ¼ë¡œ ê²°ì œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
            confirmationModal.style.display = 'flex';
        }

        function processPayment(isConfirmed) {
            closeModal(confirmationModal); 
            
            if (isConfirmed) {
                showProcessingAnimation();
            } else {
                alert("ê²°ì œê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ êµ¬ë…í•´ì£¼ì„¸ìš”.");
            }
        }
        
        function showProcessingAnimation() {
            processingText.innerText = 'ê²°ì œë¥¼ ì²˜ë¦¬í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...';
            spinner.style.display = 'block';
            successIcon.style.display = 'none';
            processingModal.style.display = 'flex';

            setTimeout(() => {
                spinner.style.display = 'none';
                successIcon.style.display = 'block';
                processingText.innerText = 'ê²°ì œ ì™„ë£Œ! í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥ì´ í™œì„±í™”ë©ë‹ˆë‹¤.';

                sessionStorage.setItem('isPremiumActive', 'true');
                checkPremiumStatus(); 

                setTimeout(() => {
                    closeModal(processingModal);
                    executeCalculation(); 
                }, 800); 
                
            }, 2000); 
        }
        
        // ìµœì¢… ê³„ì‚° ë¡œì§ (eval ê¸°ë°˜ìœ¼ë¡œ ë³µêµ¬)
        function executeCalculation() {
            if (currentExpression === '') return;
            try {
                // ì €ì¥ëœ ìˆ˜ì‹ì„ ê³„ì‚°í•˜ê³  +1ì„ ë”í•¨
                let trueResult = eval(currentExpression);
                let misleadingResult = trueResult + 1;

                display.value = String(misleadingResult);
                currentExpression = String(misleadingResult); // ê³„ì‚° ê²°ê³¼ ì €ì¥
                selectedPlanId = null; 
            } catch (error) {
                display.value = 'Error';
                setTimeout(clearDisplay, 1000);
            }
        }
        
        checkPremiumStatus();
    </script>
</body>
</html>
